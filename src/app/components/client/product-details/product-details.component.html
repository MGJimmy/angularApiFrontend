<!-- *ngIf="product != null" -->


<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="ball-pulse" [fullScreen]="true">
  <p style="color: white"> Loading... </p>
</ngx-spinner>

<section id="singleProductPage" *ngIf="product != null">

  <div class="container">
    <div id="singleProductContainer" class="row productsContainer">
      <div class="col-md-6"><img [src]="createImgPath(product.image)" class="w-100"></div>
      <div class="col-md-6">
        <h2 class="my-3 display-3">{{product.name }} </h2>
        <div class="my-3 font-italic h2">{{product.price}} </div>
        <div class="my-3 font-italic h2">{{product.categoryName}} </div>
        <div class="description my-3">{{product.description}} </div>

        <div class="colors my-3"><span class="font-weight-bold">Color : </span>{{product.colorName}} </div>
        <button type="button" class="addToChart  btn btn-primary my-3 mr-3" data-id=" product.id "><i
            class="fa fa-cart-plus"></i> Add to Cart</button>
        <button type="button" class="addedToChart  btn btn-success my-3 mr-3" data-id=" product.id "><i
            class="fas fa-check"></i> Added to Cart</button>
        <button type="button" class="addToWishList  btn btn-secondary my-3" data-id=" product.id "><i
            class="fa fa-heart" aria-hidden="true"></i> Add to WishList</button>
      </div>
    </div>
    <div class="reviews">
      <form [formGroup]="reviewForm" *ngIf="!hasReview">
        <div class="form-group my-3">
          <input formControlName="rating" min="1" max="5" type="number" name="rating">
          <textarea formControlName="comment" class="form-control comment" placeholder="Leave comment" name="comment" rows="5"></textarea>
          <!-- <div *ngIf="userName?.invalid && userName?.touched"> 
                    <small *ngIf="userName?.errors?.required" class="text-danger">user name is required</small>
                    <small *ngIf="userName?.errors?.pattern" class="text-danger">user name must be character only</small>
                </div> -->
          <button type="submit" class="btn btn-primary my-3 px-5" [disabled]="loading" (click)="addReview()"> Add </button>
        </div>
      </form>
      <div class="userReview" *ngIf="hasReview">
        <h3>YourReview</h3>
        <p>Name: {{currentUserReview.userFullName}} </p>
        <p>Rating: {{currentUserReview.rating}} </p>
        <p> comment: {{currentUserReview.comment}} </p>
      </div>
      <h2 *ngIf="reviewsCount != 0">other Reviews</h2>
      <h2 *ngIf="reviewsCount == 0">No Reviews</h2>
      <div class="loop" *ngFor="let review of allReviews;let i=index">
        <div class="review my-4" *ngIf="currentUserReview?.id != review.id">
          <p>Name: {{review.userFullName}} </p>
          <p>Rating: {{review.rating}} </p>
          <p> comment: {{review.comment}} </p>
        </div>
      </div>
      <!-- pagination -->
      <nav aria-label="..." class="">
        <div class="d-inline-block">
          <ul class="pagination">
            <li class="page-item" [ngClass]="{disabled:currentPageNumber <=1, cursorNotAllowed:currentPageNumber <=1}">
              <button class="page-link" [disabled]="currentPageNumber <=1"
                (click)="getSelectedPage(currentPageNumber-1)">Previous</button>
            </li>
            <li class="page-item" *ngFor='let x of counter(numberOfPages) ;let i = index'
              [class.active]="currentPageNumber == (i+1)">
              <a class="page-link" (click)="getSelectedPage(i+1)">{{i+1}} </a>
            </li>
            <li class="page-item"
              [ngClass]="{disabled:currentPageNumber >=numberOfPages, cursorNotAllowed:currentPageNumber >=numberOfPages}">
              <button class="page-link" [disabled]="currentPageNumber >= numberOfPages"
                (click)="getSelectedPage(currentPageNumber+1)">Next</button>
            </li>
          </ul>
        </div>
        <div class="float-right h5 mr-4 text-secondary">Showing {{currentPageNumber}} of {{numberOfPages}}</div>
      </nav>
    </div>
  </div>
</section>